<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AERVIX</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Arial;text-align:center;background:#0b1220;color:white;}
.container{margin-top:50px;}
input{padding:8px;margin:5px;border-radius:5px;border:none;}
button{padding:8px 15px;border:none;border-radius:5px;background:#ff6a2b;color:white;cursor:pointer;}
table{margin:auto;margin-top:20px;border-collapse:collapse;}
td,th{border:1px solid #555;padding:6px;}
canvas{margin-top:20px;background:#111827;padding:10px;border-radius:10px;}
</style>
</head>

<body>

<div class="container">

<h2>AERVIX Task Upload</h2>

<input id="name" placeholder="Name"><br>
<input id="email" placeholder="Email"><br>
<input id="dept" placeholder="Department"><br>
<input id="task" placeholder="Task"><br>

<button onclick="saveData()">Upload Task</button>

<hr>

<h2>Portfolio View</h2>

<input id="searchName" placeholder="Enter Name">
<button onclick="fetchData()">View Portfolio</button>

<table id="table">
<tr>
<th>Name</th><th>Email</th><th>Dept</th><th>Task</th><th>Time</th>
</tr>
</table>

<canvas id="graph" width="300" height="200"></canvas>

</div>

<script>

const URL = "YOUR_SCRIPT_URL";

function saveData(){

  let name = document.getElementById("name").value;
  let email = document.getElementById("email").value;
  let dept = document.getElementById("dept").value;
  let task = document.getElementById("task").value;

  fetch(URL +
    "?action=save" +
    "&name=" + encodeURIComponent(name) +
    "&email=" + encodeURIComponent(email) +
    "&dept=" + encodeURIComponent(dept) +
    "&task=" + encodeURIComponent(task),
  { method:"POST", mode:"no-cors" });

  alert("Saved");
}

function fetchData(){

  let name = document.getElementById("searchName").value;

  fetch(URL +
    "?action=fetch&name=" + encodeURIComponent(name))
  .then(res => res.json())
  .then(data => {

    let table = document.getElementById("table");
    table.innerHTML =
      "<tr><th>Name</th><th>Email</th><th>Dept</th><th>Task</th><th>Time</th></tr>";

    let tasksCount = {};

    data.forEach(row => {

      table.innerHTML +=
        `<tr>
          <td>${row.name}</td>
          <td>${row.email}</td>
          <td>${row.dept}</td>
          <td>${row.task}</td>
          <td>${row.time}</td>
        </tr>`;

      tasksCount[row.task] = (tasksCount[row.task] || 0) + 1;
    });

    drawGraph(tasksCount);
  });
}

function drawGraph(data){

  let labels = Object.keys(data);
  let values = Object.values(data);

  new Chart(document.getElementById("graph"), {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{
        label: "Task Count",
        data: values
      }]
    }
  });
}

</script>

</body>
</html>
