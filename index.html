<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AERVIX</title>
<script src="https://script.google.com/macros/s/AKfycbxorMDgPszzLHpoyXzCTCrAI5nL4YgwGHarl1IzpWis50Eb2YHU9bTQVUE66VN6Eg7ATw/exec"></script>

<style>
body{font-family:Arial;text-align:center;background:#0b1220;color:white;}
input{padding:8px;margin:5px;border:none;border-radius:5px;}
button{padding:8px 15px;border:none;border-radius:5px;background:#ff6a2b;color:white;}
table{margin:auto;margin-top:15px;border-collapse:collapse;}
td,th{border:1px solid #444;padding:6px;}
canvas{background:#111827;margin-top:20px;border-radius:10px;padding:10px;}
</style>
</head>

<body>

<h2>AERVIX Upload</h2>

<input id="name" placeholder="Name">
<input id="email" placeholder="Email">
<input id="dept" placeholder="Dept">
<input id="task" placeholder="Task">
<br>
<button onclick="upload()">Upload</button>

<hr>

<h2>Portfolio</h2>

<input id="search" placeholder="Enter Name">
<button onclick="fetchData()">View</button>

<table id="table">
<tr>
<th>Name</th><th>Email</th><th>Dept</th><th>Task</th><th>Time</th>
</tr>
</table>

<canvas id="chart" width="300" height="200"></canvas>

<script>

const URL = "YOUR_SCRIPT_URL";

// ================= UPLOAD =================
function upload(){

  let n = document.getElementById("name").value;
  let e = document.getElementById("email").value;
  let d = document.getElementById("dept").value;
  let t = document.getElementById("task").value;

  fetch(URL +
    "?action=save" +
    "&name=" + encodeURIComponent(n) +
    "&email=" + encodeURIComponent(e) +
    "&dept=" + encodeURIComponent(d) +
    "&task=" + encodeURIComponent(t));

  alert("Uploaded");
}

// ================= FETCH =================
function fetchData(){

  let name = document.getElementById("search").value;

  fetch(URL + "?action=fetch&name=" + encodeURIComponent(name))
  .then(res => res.json())
  .then(data => {

    let table = document.getElementById("table");
    table.innerHTML =
      "<tr><th>Name</th><th>Email</th><th>Dept</th><th>Task</th><th>Time</th></tr>";

    let count = {};

    data.forEach(r => {

      table.innerHTML +=
      `<tr>
        <td>${r.name}</td>
        <td>${r.email}</td>
        <td>${r.dept}</td>
        <td>${r.task}</td>
        <td>${r.time}</td>
      </tr>`;

      count[r.task] = (count[r.task] || 0) + 1;
    });

    drawChart(count);
  });
}

// ================= GRAPH =================
function drawChart(data){

  let labels = Object.keys(data);
  let values = Object.values(data);

  new Chart(document.getElementById("chart"), {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{
        label: "Task Count",
        data: values
      }]
    }
  });
}

</script>

</body>
</html>

